<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EDM Club</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css' />
  <style>
    body {
      background-size: cover;
      background-image: url('../images/Bg_2.jpg');
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;

      &::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.75);
        z-index: -1;
      }

      &::after {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000000;
        background: radial-gradient(circle, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 1) 50%);
        z-index: -1;
      }
    }
  </style>
  
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <script type='module' src='../components/ClubEvents.component.js'></script>
  <script type='module' src='../components/EventForm.component.js'></script>
</head>
<body class='relative min-h-screen font-[Poppins] bg-[#050609]'>
  <main class='relative lg:w-[950px] max-lg:w-full max-lg:px-4 top-0 mx-auto px-4'>
    <div>
      <header class='fixed lg:w-[950px] max-lg:w-full top-8 left-0 right-0 mx-auto p-4 border-2 border-[#201e22] rounded-xl bg-[#0d0c11] z-10'>
        <nav>
          <ul class='flex justify-center gap-4 text-[#f2e8cd]'>

          </ul>
        </nav>
      </header>
      <section id='Content' class='relative top-42 text-[#f2e8cd]'>
        <club-events club-id='1'></club-events>
      </section>
      <footer></footer>

      <event-form id='eventForm' club-id='1'></event-form>
    </div>
  </main>
  <script type='module'>
    import { initRouter } from '../helpers/Router.helper.js'

    const eventForm = document.getElementById( 'eventForm' )
    const clubEvents = document.querySelector('club-events')

    eventForm.addEventListener( 'event-created', () => {
      clubEvents.dispatchEvent( new CustomEvent( 'event-created' ) )
    } )

    document.addEventListener( 'DOMContentLoaded', () => {
      const ul                              = document.querySelector( 'header nav ul' )

      function renderNav() {
        ul.innerHTML                        = ''

        const homeLi                        = document.createElement( 'li' )
        homeLi.innerHTML                    = `<a class='block p-2 px-8 rounded-full hover:bg-neutral-800' href='#'>Home</a>`
        ul.appendChild( homeLi )

        const aboutLi                       = document.createElement( 'li' )
        aboutLi.innerHTML                   = `<a class='block p-2 px-8 rounded-full hover:bg-neutral-800' href='#'>About</a>`
        ul.appendChild( aboutLi )

        const isAdmin                       = localStorage.getItem( 'admin' ) === 'true'

        if( isAdmin ) {
          const addEventLi                  = document.createElement( 'li' )
          const addEventA                   = document.createElement( 'a' )
          addEventA.classList.add( 'block', 'p-2', 'px-8', 'rounded-full', 'hover:bg-neutral-800' )
          addEventA.href                    = '#'
          addEventA.textContent             = 'Add Event'
          addEventA.addEventListener( 'click', () => eventForm.open() )
          addEventLi.appendChild( addEventA )
          ul.appendChild( addEventLi )

          const logoutLi                    = document.createElement( 'li' )
          const logoutA                     = document.createElement( 'a' )
          logoutA.classList.add( 'block', 'p-2', 'px-8', 'rounded-full', 'text-black', 'bg-[#faefd1]', 'hover:bg-[#c8bfa7]' )
          logoutA.href                      = '#'
          logoutA.textContent               = 'Logout'
          logoutA.addEventListener( 'click', () => {
            window.localStorage.removeItem( 'admin' )
            renderNav()
            initRouter()
            eventForm.close()

            const logoutEvent               = new CustomEvent( 'logout' )
            window.dispatchEvent( logoutEvent )
          })
          logoutLi.appendChild( logoutA )
          ul.appendChild( logoutLi )
        } else {
          const adminLi                     = document.createElement( 'li' )
          const adminA                      = document.createElement( 'a' )
          adminA.classList.add( 'block', 'p-2', 'px-8', 'rounded-full', 'text-black', 'bg-[#faefd1]', 'hover:bg-[#c8bfa7]' )
          adminA.href                       = '#'
          adminA.textContent                = 'Admin'
          adminA.addEventListener( 'click', () => {
            window.localStorage.setItem( 'admin', 'true' )
            renderNav()
            initRouter()

            const loginEvent                = new CustomEvent( 'login' )
            window.dispatchEvent( loginEvent )
          })
          adminLi.appendChild( adminA )
          ul.appendChild( adminLi )
        }

        initRouter()
      }

      renderNav()
    })
  </script>
</body>
</html>